{"ast":null,"code":"import _toConsumableArray from\"/Users/asfandyarkhan/Desktop/part_select/parts-select/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _regeneratorRuntime from\"/Users/asfandyarkhan/Desktop/part_select/parts-select/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/asfandyarkhan/Desktop/part_select/parts-select/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/asfandyarkhan/Desktop/part_select/parts-select/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect,useRef}from\"react\";import\"./ChatWindow.css\";import{marked}from\"marked\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function ChatWindow(){var defaultMessage=[{role:\"assistant\",content:\"Hi, how can I help you today?\"}];var _useState=useState(defaultMessage),_useState2=_slicedToArray(_useState,2),messages=_useState2[0],setMessages=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),input=_useState4[0],setInput=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isLoading=_useState6[0],setIsLoading=_useState6[1];// New state variable for loading state\nvar messagesEndRef=useRef(null);useEffect(function(){var _messagesEndRef$curre;(_messagesEndRef$curre=messagesEndRef.current)===null||_messagesEndRef$curre===void 0?void 0:_messagesEndRef$curre.scrollIntoView({behavior:\"smooth\"});},[messages]);var getAIMessage=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(userQuery){var response,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return fetch('http://127.0.0.1:5000/api/ai-message',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({input:userQuery})});case 3:response=_context.sent;if(response.ok){_context.next=6;break;}throw new Error('Network response was not ok.');case 6:_context.next=8;return response.json();case 8:data=_context.sent;return _context.abrupt(\"return\",{role:'assistant',content:data});case 12:_context.prev=12;_context.t0=_context[\"catch\"](0);console.error('Failed to fetch data:',_context.t0);return _context.abrupt(\"return\",{role:'assistant',content:\"Error processing your request.\"});case 16:case\"end\":return _context.stop();}},_callee,null,[[0,12]]);}));return function getAIMessage(_x){return _ref.apply(this,arguments);};}();var handleSend=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var trimmedInput,response;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:trimmedInput=input.trim();if(!trimmedInput){_context2.next=18;break;}setMessages(function(prevMessages){return[].concat(_toConsumableArray(prevMessages),[{role:\"user\",content:trimmedInput}]);});setInput(\"\");setIsLoading(true);// Set loading state to true before starting AI processing\n_context2.prev=5;_context2.next=8;return getAIMessage(trimmedInput);case 8:response=_context2.sent;if(response&&response.content){// Ensure that the response content is being used here\nsetMessages(function(prevMessages){return[].concat(_toConsumableArray(prevMessages),[response]);});}else{console.error(\"No content in response:\",response);}_context2.next=15;break;case 12:_context2.prev=12;_context2.t0=_context2[\"catch\"](5);console.error(\"Error fetching AI message:\",_context2.t0);case 15:_context2.prev=15;setIsLoading(false);// Set loading state to false after AI processing is done\nreturn _context2.finish(15);case 18:case\"end\":return _context2.stop();}},_callee2,null,[[5,12,15,18]]);}));return function handleSend(){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:\"messages-container\",children:[messages.map(function(message,index){return/*#__PURE__*/_jsx(\"div\",{className:\"\".concat(message.role,\"-message-container\"),children:/*#__PURE__*/_jsx(\"div\",{className:\"message \".concat(message.role,\"-message\"),children:message.content&&/*#__PURE__*/_jsx(\"div\",{dangerouslySetInnerHTML:{__html:marked(message.content||'')}})})},index);}),isLoading&&/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"}),/*#__PURE__*/_jsx(\"div\",{ref:messagesEndRef}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-area\",children:[/*#__PURE__*/_jsx(\"input\",{value:input,onChange:function onChange(e){return setInput(e.target.value);},placeholder:\"Type a message...\",onKeyPress:function onKeyPress(e){if(e.key===\"Enter\"&&!e.shiftKey){handleSend();e.preventDefault();}}}),/*#__PURE__*/_jsx(\"button\",{className:\"send-button\",onClick:handleSend,children:\"Send\"})]})]});}export default ChatWindow;","map":{"version":3,"names":["React","useState","useEffect","useRef","marked","jsx","_jsx","jsxs","_jsxs","ChatWindow","defaultMessage","role","content","_useState","_useState2","_slicedToArray","messages","setMessages","_useState3","_useState4","input","setInput","_useState5","_useState6","isLoading","setIsLoading","messagesEndRef","_messagesEndRef$curre","current","scrollIntoView","behavior","getAIMessage","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","userQuery","response","data","wrap","_callee$","_context","prev","next","fetch","method","headers","body","JSON","stringify","sent","ok","Error","json","abrupt","t0","console","error","stop","_x","apply","arguments","handleSend","_ref2","_callee2","trimmedInput","_callee2$","_context2","trim","prevMessages","concat","_toConsumableArray","finish","className","children","map","message","index","dangerouslySetInnerHTML","__html","ref","value","onChange","e","target","placeholder","onKeyPress","key","shiftKey","preventDefault","onClick"],"sources":["/Users/asfandyarkhan/Desktop/part_select/parts-select/src/components/ChatWindow.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\nimport \"./ChatWindow.css\";\nimport { marked } from \"marked\";\n\nfunction ChatWindow() {\n  const defaultMessage = [{\n    role: \"assistant\",\n    content: \"Hi, how can I help you today?\"\n  }];\n\n  const [messages, setMessages] = useState(defaultMessage);\n  const [input, setInput] = useState(\"\");\n  const [isLoading, setIsLoading] = useState(false);  // New state variable for loading state\n  const messagesEndRef = useRef(null);\n\n  useEffect(() => {\n    messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\n  }, [messages]);\n\n  const getAIMessage = async (userQuery) => {\n    try {\n      const response = await fetch('http://127.0.0.1:5000/api/ai-message', {\n        method: 'POST',\n        headers: {'Content-Type': 'application/json'},\n        body: JSON.stringify({ input: userQuery })\n      });\n      if (!response.ok) {\n        throw new Error('Network response was not ok.');\n      }\n      const data = await response.json();\n      return { role: 'assistant', content: data }; \n    } catch (error) {\n      console.error('Failed to fetch data:', error);\n      return { role: 'assistant', content: \"Error processing your request.\" };\n    }\n  };\n\n  const handleSend = async () => {\n    const trimmedInput = input.trim();\n    if (trimmedInput) {\n      setMessages(prevMessages => [...prevMessages, { role: \"user\", content: trimmedInput }]);\n      setInput(\"\");\n      setIsLoading(true);  // Set loading state to true before starting AI processing\n  \n      try {\n        const response = await getAIMessage(trimmedInput);\n        if (response && response.content) {\n          // Ensure that the response content is being used here\n          setMessages(prevMessages => [...prevMessages, response]);\n        } else {\n          console.error(\"No content in response:\", response);\n        }\n      } catch (error) {\n        console.error(\"Error fetching AI message:\", error);\n      } finally {\n        setIsLoading(false);  // Set loading state to false after AI processing is done\n      }\n    }\n  };\n\n  return (\n    <div className=\"messages-container\">\n      {messages.map((message, index) => (\n        <div key={index} className={`${message.role}-message-container`}>\n          <div className={`message ${message.role}-message`}>\n            {message.content && <div dangerouslySetInnerHTML={{ __html: marked(message.content || '') }}></div>}\n          </div>\n        </div>\n      ))}\n      {isLoading && <div>Loading...</div>}  \n      <div ref={messagesEndRef} />\n      <div className=\"input-area\">\n        <input\n          value={input}\n          onChange={(e) => setInput(e.target.value)}\n          placeholder=\"Type a message...\"\n          onKeyPress={(e) => {\n            if (e.key === \"Enter\" && !e.shiftKey) {\n              handleSend();\n              e.preventDefault();\n            }\n          }}\n        />\n        <button className=\"send-button\" onClick={handleSend}>Send</button>\n      </div>\n    </div>\n  );\n}\n\nexport default ChatWindow;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}